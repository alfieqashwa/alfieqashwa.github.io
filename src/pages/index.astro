---
import GithubCalendar from "@/components/react/GithubCalendar.tsx";
import WakatimeGraph from "@/components/react/WakatimeGraph.tsx";
import Link from "@/components/Link.astro";
import PageHead from "@/components/PageHead.astro";
import { SOCIAL_LINKS } from "@/consts";
import Layout from "@/layouts/Layout.astro";
import { getAllAuthors, getAllPosts } from "@/lib/data-utils";
import { cn } from "@/lib/utils";
import { Icon } from "astro-icon/components";
import AvatarComponent from "@/components/ui/avatar";
import { DecorativeBadges } from "@/components/react/DecorativeBadges";

const latestPost = await getAllPosts().then((posts) => posts.at(0));
const authors = await getAllAuthors();
const avatar = authors?.[0]?.data.avatar ?? "aq";
---

<Layout class="px-2">
  <PageHead slot="head" title="Home" />
  <section
    class={cn(
      "mx-auto grid min-w-xs sm:has-[[data-trigger]:hover]:*:first:[&_[data-overlay]]:opacity-0",
      'max-w-sm grid-cols-1 [grid-template-areas:"a""b""e""h""i""c""k""d""g""f""j"]',
      'sm:max-w-2xl sm:grid-cols-2 sm:[grid-template-areas:"a_a""b_d""e_e""j_g""h_i""h_c""k_c""f_f"]',
      'lg:max-w-5xl lg:grid-cols-3 lg:[grid-template-areas:"a_a_b""d_e_e""h_f_f""h_i_g""k_c_j"]',
      'xl:max-w-7xl xl:grid-cols-4 xl:[grid-template-areas:"a_a_b_c""d_e_e_c""h_f_f_g""h_i_j_k"]'
    )}
  >
    <div class="aspect-[3/4] p-2 [grid-area:a] sm:aspect-[2/1] xl:aspect-[2/1]">
      <div class="bg-muted size-full border">
        <div
          class="size-full bg-[url('/static/about-background-square.png')] bg-cover bg-center bg-no-repeat sm:bg-[url('/static/about-background.png')]"
        >
          <div
            data-overlay
            class="size-full bg-[url('/static/about-foreground-square.png')] bg-cover bg-center bg-no-repeat transition-opacity duration-200 sm:bg-[url('/static/about-foreground.png')]"
          >
            <div class="flex p-4">
              <div class="hidden w-1/3 sm:block"></div>
              <div class="space-y-4 sm:w-2/3">
                <p
                  class="text-foreground/80 bg-background block border p-3 text-sm text-pretty"
                >
                  Hey, I&rsquo;m Alfie! I'm a software engineer and tech
                  enthusiast from Indonesia.
                </p>
                <p
                  class="text-foreground/80 bg-background block border p-3 text-sm text-pretty"
                >
                  I enjoy building web applications, exploring new technologies,
                  and sharing my learning journey through this digital garden.
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="aspect-square p-2 [grid-area:b]">
      <div data-trigger class="bg-muted size-full border">
        <div
          class="size-full bg-[url('/static/details-background.png')] bg-cover bg-center bg-no-repeat"
        >
          <div
            class="relative size-full bg-[url('/static/details-foreground.png')] bg-cover bg-center bg-no-repeat transition-opacity duration-200 sm:opacity-0 sm:hover:opacity-100"
          >
            <div
              class="p-6 h-full flex flex-col justify-center items-center text-center"
            >
            </div>
            <p
              class="text-foreground/80 bg-background absolute top-1/2 left-0 mr-24 ml-4 -translate-y-1/2 border p-3 text-xs text-pretty"
            >
              Explore my recent projects
              <a
                href="/projects"
                class="inline-flex mt-4 items-center text-sm border border-border bg-background hover:bg-accent px-3 py-2 rounded transition-colors"
              >
                View Projects
                <svg
                  width="16"
                  height="16"
                  class="ml-2"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path d="M13 5h6v6m0-6L5 19"></path>
                </svg>
              </a>
            </p>
          </div>
        </div>
      </div>
    </div>
    <div
      class="aspect-square p-2 [grid-area:c] sm:aspect-[1/2] lg:aspect-square xl:aspect-[1/2]"
    >
      <div class="bg-muted size-full border">
        <div
          class="size-full bg-[url('/static/image-1.png')] bg-cover bg-center bg-no-repeat"
        >
        </div>
      </div>
    </div>

    <div class="aspect-auto p-2 [grid-area:d] sm:aspect-square">
      <div class="bg-muted size-full border">
        <div
          data-trigger
          class="group/discord relative size-full overflow-hidden"
        >
          <p
            class="text-foreground/80 bg-muted absolute top-4 left-30 hidden border p-2 text-xs opacity-0 transition-opacity duration-200 group-hover/discord:opacity-100 sm:block"
          >
            Feel free
            <br />
            to add me!
          </p>
          <div class="grid size-full grid-rows-4">
            <div
              class="bg-border/25 bg-[url('/static/bento/discord-banner.png')] bg-cover bg-center bg-no-repeat"
            >
            </div>
            <div class="bg-muted row-span-3 flex flex-col gap-3 p-3">
              <div class="flex justify-between gap-x-1">
                <div class="relative">
                  <AvatarComponent
                    client:load
                    src={avatar}
                    fallback="AQ"
                    alt="Avatar"
                    className="-mt-12 aspect-square size-16 rounded-full sm:-mt-[4.5rem] sm:size-24"
                  />
                  <div
                    class="absolute inset-0 -mt-12 aspect-square size-16 rounded-full bg-cover bg-center bg-no-repeat opacity-0 transition-opacity duration-200 group-hover/discord:opacity-100 sm:-mt-[4.5rem] sm:size-24 sm:bg-[url('/static/bento/avatar-foreground.png')]"
                    aria-hidden="true"
                  >
                  </div>
                </div>
                <DecorativeBadges />
              </div>
              <div class="bg-border/50 flex-1 p-3">
                <div class="flex size-full items-center gap-x-2 sm:gap-x-3">
                  <div
                    class="relative aspect-square h-full max-h-12 shrink-0 sm:max-h-16"
                  >
                    <div
                      style={{
                        backgroundImage: `url('/static/radiohead.webp')`,
                      }}
                      class="absolute inset-0 bg-contain bg-center bg-no-repeat grayscale sepia-50"
                    >
                    </div>
                  </div>

                  <div class="flex flex-1 flex-col gap-y-1 py-1">
                    <div class="mb-0.5 line-clamp-1 text-xs leading-none">
                      OK Computer
                    </div>
                    <div
                      class="text-muted-foreground line-clamp-2 text-[11px] leading-none"
                    >
                      how to disappear completely
                    </div>
                    <div
                      class="text-muted-foreground line-clamp-1 text-[11px] leading-none"
                    >
                      without being found
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="aspect-[6/5] p-2 [grid-area:e] sm:aspect-[2/1]">
      <div data-trigger class="bg-muted size-full border">
        <div
          class="group/blog relative size-full bg-[url('/static/blog-background-square.png')] bg-cover bg-center bg-no-repeat sm:bg-[url('/static/blog-background.png')]"
        >
          <div
            class="absolute size-full bg-[url('/static/blog-foreground-square.png')] bg-cover bg-center bg-no-repeat transition-opacity duration-200 sm:bg-[url('/static/blog-foreground.png')] sm:opacity-0 sm:group-hover/blog:opacity-100"
          >
            <p
              class="text-foreground/80 bg-background absolute bottom-4 left-16 border p-2 text-xs text-pretty sm:top-[42.5%] sm:right-4 sm:bottom-[inherit] sm:left-[inherit] sm:-translate-y-1/2"
            >
              Read my latest<br /> blog post!
            </p>
          </div>
          <div class="p-3 sm:size-full sm:p-6">
            {
              latestPost && (
                <Link href={`/blog/${latestPost.id}`} class="flex h-full">
                  <img
                    src={latestPost.data.image?.src ?? "#"}
                    alt={`Featured image for the latest post: ${latestPost.data.title}`}
                    class="h-full border"
                  />
                </Link>
              )
            }
          </div>
          {
            latestPost && (
              <Link
                href={`/blog/${latestPost.id}`}
                title={`Read latest blog post: ${latestPost.data.title}`}
                aria-label={`Read latest blog post: ${latestPost.data.title}`}
                class="bg-border/50 text-primary ring-ring group/blog-link absolute end-0 bottom-0 m-3 rounded-full p-3 transition-[box-shadow] duration-300 hover:ring-2 focus-visible:ring-2"
              >
                <Icon
                  name="lucide:move-up-right"
                  class="transition-transform duration-300 group-hover/blog-link:rotate-12"
                  size={16}
                />
              </Link>
            )
          }
        </div>
      </div>
    </div>
    <div class="aspect-square p-2 [grid-area:f] sm:aspect-[2/1]">
      <div data-trigger class="bg-muted relative size-full border">
        <div
          class="absolute size-full bg-[url('/static/calendar-background.png')] bg-cover bg-left bg-no-repeat"
        >
          <div
            class="absolute size-full bg-[url('/static/calendar-foreground.png')] bg-cover bg-left bg-no-repeat transition-opacity duration-200 sm:opacity-0 sm:hover:opacity-100"
          >
            <p
              class="text-foreground/80 bg-background absolute top-[37.5%] left-4 -translate-y-1/2 border p-2 text-xs text-pretty"
            >
              Check out my<br /> GitHub calendar!
            </p>
          </div>
        </div>
        <div class="flex size-full items-center justify-center p-8">
          <GithubCalendar username="alfieqashwa" client:load />
        </div>
      </div>
    </div>
    <div class="aspect-square p-2 [grid-area:g]">
      <div data-trigger class="bg-muted size-full border">
        <div
          class="group/spotify relative size-full bg-[url('/static/spotify-background.png')] bg-cover bg-center bg-no-repeat"
        >
          <div
            class="absolute size-full bg-[url('/static/spotify-foreground.png')] bg-cover bg-center bg-no-repeat transition-opacity duration-200 sm:opacity-0 sm:group-hover/spotify:opacity-100"
          >
            <p
              class="text-foreground/80 bg-background absolute top-[72.5%] left-5 -translate-y-1/2 border p-2 text-xs text-pretty"
            >
              I'm a Grunge Lover!
            </p>
          </div>
          <div class="flex size-full items-center justify-center">
            <img src="/static/kurt-cobain.jpg" alt="Kurt Cobain" class="p-4" />
          </div>
        </div>
      </div>
    </div>
    <div class="aspect-square p-2 [grid-area:h] sm:aspect-[1/2]">
      <div class="bg-muted size-full border">
        <div
          class="size-full bg-[url('/static/image-2.png')] bg-cover bg-center bg-no-repeat"
        >
        </div>
      </div>
    </div>
    <div class="aspect-square p-2 [grid-area:i]">
      <div class="bg-muted size-full border">
        <div
          class="group/github relative flex size-full items-center justify-center bg-[url('/static/github-background.png')] bg-cover bg-center bg-no-repeat"
        >
          <div
            class="size-full bg-[url('/static/github-foreground.png')] bg-cover bg-center bg-no-repeat transition-opacity duration-200 sm:opacity-0 sm:group-hover/github:opacity-100"
            aria-hidden="true"
          >
          </div>
          <Icon
            name="mdi:github"
            class="text-primary absolute size-1/2 sm:size-24"
            aria-hidden="true"
          />
          <Link
            href={SOCIAL_LINKS.find((link) => link.label === "GitHub")?.href ||
              "#"}
            title="Visit my GitHub profile"
            aria-label="Visit my GitHub profile"
            external
            class="bg-border/50 text-primary ring-ring group/github-link absolute end-0 bottom-0 m-3 rounded-full p-3 transition-[box-shadow] duration-300 hover:ring-2 focus-visible:ring-2"
          >
            <Icon
              name="lucide:move-up-right"
              class="transition-transform duration-300 group-hover/github-link:rotate-12"
              size={16}
            />
          </Link>
        </div>
      </div>
    </div>
    <div class="aspect-square p-2 [grid-area:j]">
      <div class="bg-muted size-full border">
        <WakatimeGraph omitLanguages={["Markdown", "JSON"]} client:load />
      </div>
    </div>
    <div class="aspect-square p-2 [grid-area:k]">
      <div data-trigger class="bg-muted size-full border">
        <div
          class="group/twitter relative flex size-full items-center justify-center bg-[url('/static/twitter-background.png')] bg-cover bg-center bg-no-repeat"
        >
          <div
            class="size-full bg-[url('/static/twitter-foreground.png')] bg-cover bg-center bg-no-repeat transition-opacity duration-200 sm:opacity-0 sm:group-hover/twitter:opacity-100"
            aria-hidden="true"
          >
            <p
              class="text-foreground/80 bg-background absolute bottom-4 left-4 hidden border p-2 text-xs text-pretty sm:block"
            >
              TypeScript is<br />much better!
            </p>
          </div>
          <Icon
            name="mdi:twitter"
            class="text-primary absolute size-1/2 sm:size-24"
            aria-hidden="true"
          />
          <Link
            href={SOCIAL_LINKS.find((link) => link.label === "Twitter")?.href ||
              "#"}
            title="Visit my Twitter profile"
            aria-label="Visit my Twitter profile"
            external
            class="bg-border/50 text-primary ring-ring group/twitter-link absolute end-0 bottom-0 m-3 rounded-full p-3 transition-[box-shadow] duration-300 hover:ring-2 focus-visible:ring-2"
          >
            <Icon
              name="lucide:move-up-right"
              class="transition-transform duration-300 group-hover/twitter-link:rotate-12"
              size={16}
            />
          </Link>
        </div>
      </div>
    </div>
  </section>
</Layout>
